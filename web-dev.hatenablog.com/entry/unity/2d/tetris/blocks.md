---
Title: テトリス考察：ブロック
Category:
- Unity
Date: 2020-07-25T00:00:00+09:00
URL: https://web-dev.hatenablog.com/entry/unity/2d/tetris/blocks
EditURL: https://blog.hatena.ne.jp/mamorums/web-dev.hatenablog.com/atom/entry/26006613601481660
Draft: true
---

Unity 2D でテトリスを制作したときのメモで、下のリンク先のコードを書くときに考えた内容です。

[https://web-dev.hatenablog.com/entry/unity/2d/tetris/overview:embed:cite]

※1. 公式の仕様は分かりません。  
※2. リンク先の参考文献のほうが分かりやすいかもしれません。


## ブロックの中心
まず、ブロックの中心（軸）を `(x, y)` で表すことにしてます。

落下などの、位置が変わる場合は、

- ブロックが落下：`(x, y-1)`
- ブロックが左右移動：`(x-1, y)` or `(x+1, y)`

といった感じで表現できそうです。


## 中心位置と相対位置
テトリスのブロックは、４つのセル（四角形）から構成されています。

そう考えると、

- 軸のセル（中心位置）
- 他のセル（相対位置）

が分かればブロック全体を表現できます。例えば、以下の通りです。

### O字ブロック
[f:id:mamorums:20200720232719j:plain]

色付きのセル `(0, 0)` が中心で、他のセルの相対的な位置は、

- `(0, 1)`
- `(1, 1)`
- `(1, 0)`

になります。それぞれに中心の位置を足すと、セルの場所が取得できます。他のブロックも続けて書いていきます。

### I,S,Z字ブロック
[f:id:mamorums:20200720232919p:plain]

回転する場合でも、回転パターンに応じた相対位置が分かればブロック全体を表現できます。

### J,L,T字ブロック
[f:id:mamorums:20200720232929j:plain]

２回転のブロックと同じです。相対位置は図の中だけ記載してます。


## 回転数
ブロックはそれぞれ、

- ０回転（O字ブロック）
- ２回転（I, S, Z字ブロック）
- ４回転（J, L, T字ブロック）

に分けて考えてます。

全部４回転させても良いのかもしれませんが、O字ブロックが回転してた記憶はあまりないです。I,S,Z字ブロックも、回転数少ないほうがシンプルな気はします。


## まとめ
ブロックの表示・回転・移動は、下の情報があれば実装できそうです。

- 中心位置
- 回転パターンと相対位置

１つ注意したい点は、厳密に回転しているわけではなくて、次の相対位置を取得してブロックを再構成する、という点です。

回転途中にぶつかるブロック（セル）が存在してても、次の相対位置がそれにぶつからなければOK、という実装方法になります。


